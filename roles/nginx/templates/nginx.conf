events {
    worker_connections 768;
}
http{
  upstream ui {
    server {{ ui_domain }}:3030;
  }
  upstream jenkins {
    server {{ jenkins_domain }}:8080;
  }
  server {
    listen 80;
    access_log  /var/log/nginx/jenkins.access.log;
    error_log   /var/log/nginx/jenkins.error.log;

    location /jenkins {
      proxy_pass http://jenkins;
#      proxy_redirect http://jenkins/jenkins /;
    }
  }
  server {
    listen 80;
    access_log  /var/log/nginx/ui.access.log;
    error_log   /var/log/nginx/ui.error.log;

    location /ui {
      proxy_pass http://ui;
      proxy_redirect http://jenkins/ /ui;
    }
  }
}
